# 第4章 JavaScript运算符和表达式

JavaScript语言的运算符可分为以下几类:

* 算术运算符
* 关系运算符
* 逻辑运算符
* 赋值运算符
* 条件运算符


## 4.1 算术运算符

JavaScript语言中基本的数学运算：| 操作符| 举例|运算结果|
| :--- | :--- |:--- |
| + | m=5+5 |两数之和，10|
| - | m=9-4 |两数之差，5|
| * | m=3*4 |两数之积，12|| / | m=1/2|两数的比值，0.5|| % | m=3%2|两数据相除的余数，1（此余数可以为小数）|| ** | m=2 ** 3|指数运算，8（等价于 m = 2 * 2 * 2）|
|++|let m = 0;m++|自增运算|
|--|let m = 0;m--|自减运算|



### 4.1.1 求余运算

通过求余运算符，我们可以得出两数相除的余数。例如：

```
const m = 3%2;
console.log(m);//输出为1
```
这个求余运算比较好理解，3不能被2整除，所以会有余数，余数为1。

**但求余操作不仅能对整数进行，还能够对小数进行，这一点需要重点理解。**

例如：

```
const m1 = 2.5%0.5;
console.log(m1);//m值为0

const m2 = 2.6%0.5;
console.log(m2);//m值为0.1
```

对于小数的求余操作，不能简单的理解为两数相除。应当把除数（除号右边的数）作为一个单位。将被除数（除号左边的数）按该单位进行除法操作，不能整除的部分便是余数。

### 4.1.2 自增自减运算

自增1 运算符记为“++”，其功能是使变量的值自增 1。 自减 1 运算符记为“--”，其功能是使变量值自减 1。
自增 1，自减 1 运算符均为单目运算，都具有右结合性。可有以下几种形式:

* `++i`，i自增1后再参与其他运算
* `--i`，i自减1后再参与其他运算
* `i++`，i参与运算后，i的值再自增1
* `i--`，i参与运算后，i的值再自减1

在理解和使用上容易出错的是 i++和 i--。 特别是当它们出在较复杂的表达式或语句中时，常常难于弄清，因此应仔细分析。

【例 4.1】

```
let i = 5;
let j = 5;

const p = (i++)+(i++)+(i++);
const q = (++j)+(++j)+(++j);
```解答：

这个程序中，对 p=(i++)+(i++)+(i++)应对操作进行拆分进行，第一个小括号的值为5，经过第一个小括号i的值变为6，第二个小括号的值为6，经过第二个小括号i的值变为7，第三个小括号的值为7，经过第三个小括号i的值变为8。所以p = 5+6+7，结果为18。

同理，对q的运算也进行拆分，第一个小括号的值为6，经过第一个小括号i的值变为6，第二个小括号的值为7，经过第二个小括号i的值变为7，第三个小括号的值为8，经过第三个小括号i的值变为8。所以p = 6+7+8，结果为21。

### 4.1.3 指数运算

使用`**`可以对变量进行指数运算。例如：

```
const a = 2 ** 3;
```

a的值为`2*2*2`。对于整数比较好理解，但同时此运算符也支持小数。例如

```
const b = 4 ** 0.5;
```
b的值为2，0.5次幂相当于开方运算。

```
const c = 4 ** 1.5;
```
c的值为8，因1.5转换成分数为3/2，即对`4*4*4`的结果开方运算。

## 4.2 关系运算符

JavaScript语言中有以下关系运算符：

| 操作符| 描述|
| :--- | :--- |
| < | 小于|
|<=| 小于或等于|
|>|大于|
|>=|大于等于|
|==|等于|
|===|绝对等于|
|!=|不等于|
|!==|不绝对等于,值和类型有一个不相等，或两个都不相等|

变量通过关系运算符计算的结果为布尔类型。

### 4.2.1 等于与绝对等于

JavaScript在设计时，有两种比较运算符：

```
false == 0; // true
false === 0; // false
```


第一种是`==`比较，它会自动转换数据类型再比较，很多时候，会得到非常诡异的结果；

第二种是`===`比较，它不会自动转换数据类型，如果数据类型不一致，返回false，如果一致，再比较。

由于JavaScript这个设计缺陷，不要使用==比较，始终坚持使用===比较。


### 4.2.2 多项不等式

在使用关系不等式处理范围问题时，经常遇到需要判断一个变量的值是否再一个范围，例如：
需要判断一个变量，是否大于3的同时小于7。
我们可能会这样使用关系运算符

```
const x = 8;
3<x<7;//运行结果为真
```

但这样的结果明显是错误。原因为这个多项不等式会分节运行，首先运行`3<x`部分，该部分的值只会为`true`或`false`，这两个值在运算中按1和0进行。所以不论x的值为多少，在后面`(true/false)<7`都成立。

正确做法应使用逻辑运算

```
x>3 && x<7
```

>关于逻辑运算可阅读下一章节。


## 4.3 逻辑运算符
逻辑运算是对真、假关系的运算，在运算中只要真、假两个值，运算结果也只用真假表示。JavaScript语言中提供了三种逻辑运算符：

| 操作符| 描述|
| :--- | :--- |
| `&&` |与运算|
|`||`|或运算|
|`!`|非运算|

运算规则为：

* 与运算 `&&`:参与运算的两个量都为真时，结果才为真，否则为假。
* 或运算`||`:参与运算的两个量只要有一个为真，结果就为真。 两个量都为假时，结果为假。
* 非运算`!`:参与运算量为真时，结果为假;参与运算量为假时，结果为真。

逻辑运算符一般与比较运算符捆绑使用，用以引入多个控制的条件，以控制JavaScript脚本代码的流向。



## 4.4 运算符优先级

JavaScript中的运算符优先级是一套规则。该规则在计算表达式时控制运算符执行的顺序。具有较高优先级的运算符先于较低优先级的运算符执行。例如，乘法的执行先于加法，例如：

```
const a = 5+2*3;
console.log(a);//输出为11，而不是10。
```
下表中为部分常用运算符按从最高到最低的优先级列出JavaScript运算符。具有相同优先级的运算符按从左至右的顺序求值

| 运算符| 描述|
| :--- | :--- |
|`.` `[]` `()`|	字段访问、数组下标、函数调用以及表达式分组|
|`**` `++` `--` `-` `~` `!` `delete` `new` `typeof` `void`|	一元运算符、返回数据类型、对象创建、未定义值|
|`*` `/` `%`	| 乘法、除法、取模|
|`+` `-` `+`	|加法、减法、字符串连接|
|`<` `<=` `>` `>=`	|小于、小于等于、大于、大于等于|
|`==` `!=` `===` `!==`|	等于、不等于、严格相等、非严格相等|
|`&&`	|逻辑与|
|`||`	|逻辑或|
|`?:`	|条件|
|`=` `oP=`|赋值、运算赋值|
|`,`|多重求值|

在表达式中，优先级较高的先于优先级较低的进行运算。而在一个运算量两侧的运算符 优先级相同时，则按运算符的结合性所规定的结合方向处理。

大家并不需要记忆其具体的优先级，这里也不做要求，我们在编写代码时遇到除加减乘除之外的运算符，尽量使用`()`进行优先级显示标注。

例如：

```
const a = 2%5*3;//这样写不好。

const b = (2%5)*3;//显示标注运算优先级
//或
const c = 2%(5*3);

```
上述代码中，`a`与`b`的值相等为6，`c`的值为2。

## 4.5 赋值运算符
简单赋值运算符和表达式:简单赋值运算符记为“=”。由“= ”连接的式子称为赋值表达式。其一般形式为: 变量=表达式。

例如：

```
let a;
a = 1+2;
```

除等号之外，为提升程序运行效率，JavaScript还提供复合赋值运算符，将算术运算和赋值操作合二为一。


| 运算符| 描述|
| :--- | :--- |
|`+=`|加赋值|
|`-=`|减赋值|
|`*=`|乘赋值|
|`/=`|除赋值|
|`%=`|求余赋值|
|`**=`|指数赋值|

```
let a = 1;
a += 2;//等价为 a = a+2;
console.log(a);//值为3
```

## 4.6条件运算符

如果在条件语句中，只执行单个的赋值语句时， 常可使用条件表达式来实现。不但使 程序简洁，也提高了运行效率。

条件运算符为?和:，它是一个三目运算符，即有三个参与运算的量。

`表达式 1? 表达式 2: 表达式 3`

其求值规则为:如果表达式 1 的值为真，则以表达式 2 的值作为条件表达式的值，否 则以表达式 2 的值作为整个条件表达式的值。条件表达式通常用于赋值语句之中。

`max=(a>b)?a:b;`

执行该语句的语义是:如 a>b 为真，则把 a 赋予 max，否则把 b 赋予 max。





